package com.pluralsight.springboot.tickets;

import java.util.NoSuchElementException;

import org.springframework.web.bind.annotation.PutMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import com.pluralsight.springboot.tickets.registration.Registration;
import com.pluralsight.springboot.tickets.repository.RegistrationReository;
@RestController
@RequestMapping(path = "/registrations")
public class RegistrationController {
	
	private final RegistrationReository registrationReository;
	
	//constructor
	public RegistrationController(RegistrationReository registrationReository) {
		this.registrationReository = registrationReository;
	}
	
	@PutMapping
	public Registration createRegistration(@RequestBody Registration registration)
	{//Create a Registration
		return registrationReository.createRegistration(registration);
	}
	
	
	public Registration getRegistrationByTicketCode(String ticketCode)
	{//Get Registration entry ByTicketCOde
		return registrationReository.findByTicketCode(ticketCode).orElseThrow(() -> new NoSuchElementException("Registration with given ticketcode "+ticketCode +" Not found"));
		
	}
	
	
	public Registration updateRegistration(Registration registration)
	{//Update a Registration if exists
		return registrationReository.updateRegistration(registration);
	}
	
	public void deleteRegistrationByTicketCode(String ticketCode)
	{//Delete a Registration based on Ticket Code Passed
		
		registrationReository.deleteByTicketCode(ticketCode);
	}

}
